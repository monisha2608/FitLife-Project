<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="FitLife.Views.DashboardPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:models="clr-namespace:FitLife.Models"
    Title="Dashboard"
    Padding="16">

    <ContentPage.Resources>

        <!-- Title text style -->
        <Style x:Key="PageTitle" TargetType="Label">
            <Setter Property="FontSize" Value="36" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="HorizontalTextAlignment" Value="Center" />
            <Setter Property="Margin" Value="0,0,0,12" />
            <Setter Property="TextColor">
                <Setter.Value>
                    <AppThemeBinding Light="{StaticResource PrimaryColor}"
                                     Dark="{StaticResource AccentColor}" />
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Header style for sections -->
        <Style x:Key="SectionHeader" TargetType="Label" BasedOn="{StaticResource H2}">
            <Setter Property="TextColor" Value="{StaticResource PrimaryColor}" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="Margin" Value="0,16,0,4" />
        </Style>

        <!-- Numbers styling -->
        <Style x:Key="StatValue" TargetType="Label">
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="FontSize" Value="22" />
            <Setter Property="TextColor" Value="{StaticResource AccentColor}" />
        </Style>

        <!-- Card style for workouts -->
        <Style x:Key="SmallCard" TargetType="Frame" BasedOn="{StaticResource Card}">
            <Setter Property="Padding" Value="12" />
            <Setter Property="WidthRequest" Value="280" />
            <Setter Property="HeightRequest" Value="130" />
            <Setter Property="HasShadow" Value="False" />
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Margin" Value="0,0,12,0" />
        </Style>
    </ContentPage.Resources>

    <ScrollView>
        <VerticalStackLayout Spacing="18">

            <!-- App title -->
            <Label Text="FitLife" Style="{StaticResource PageTitle}" />

            <!-- Add new button -->
            <Button Text="+ New"
                    Style="{StaticResource OutlineButton}"
                    HorizontalOptions="Fill" />

            <!-- Stats box -->
            <Frame Style="{StaticResource Card}">
                <Grid ColumnDefinitions="*,*" ColumnSpacing="12">

                    <!-- Calories block -->
                    <VerticalStackLayout Spacing="4">
                        <Label Text="Calories today" Style="{StaticResource Caption}" />
                        <Label Text="{Binding CaloriesToday, FallbackValue=0, TargetNullValue=0}"
                               Style="{StaticResource StatValue}" />
                    </VerticalStackLayout>

                    <!-- Minutes block -->
                    <VerticalStackLayout Grid.Column="1" Spacing="4" HorizontalOptions="End">
                        <Label Text="Minutes this week" Style="{StaticResource Caption}" HorizontalOptions="End" />
                        <Label Text="{Binding MinutesThisWeek, FallbackValue=0, TargetNullValue=0}"
                               Style="{StaticResource StatValue}" HorizontalOptions="End" />
                    </VerticalStackLayout>

                </Grid>
            </Frame>

            <!-- Workouts section title -->
            <Label Text="Today’s Workouts" Style="{StaticResource SectionHeader}" />

            <!-- Divider line -->
            <BoxView HeightRequest="1" Color="{StaticResource BorderColor}" Opacity="0.4" />

            <!-- List of workouts -->
            <CollectionView ItemsSource="{Binding TodayWorkouts}" SelectionMode="None">
                <CollectionView.ItemTemplate>
                    <DataTemplate>

                        <!-- Workout card -->
                        <Frame BackgroundColor="White"
                               CornerRadius="16"
                               Margin="0,10,10,10"
                               Padding="12"
                               HasShadow="True">

                            <VerticalStackLayout Spacing="4">

                                <!-- Workout title -->
                                <Label Text="{Binding Title}"
                                       FontSize="18"
                                       FontAttributes="Bold"
                                       TextColor="{StaticResource TextDark}" />

                                <!-- Workout category -->
                                <Label Text="{Binding Category}"
                                       FontSize="14"
                                       TextColor="{StaticResource TextLight}" />

                                <!-- Duration and calories -->
                                <HorizontalStackLayout Spacing="8">
                                    <Label Text="{Binding DurationMins, StringFormat='{}{0} min'}" />
                                    <Label Text="•" />
                                    <Label Text="{Binding Calories, StringFormat='{}{0} kcal'}" />
                                </HorizontalStackLayout>

                                <!-- Workout level -->
                                <Label Text="{Binding Level}"
                                       FontSize="12"
                                       TextColor="{StaticResource AccentColor}" />

                            </VerticalStackLayout>

                        </Frame>

                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Navigation buttons -->
            <Button Text="Workouts"
                    Style="{StaticResource PrimaryButton}"
                    Margin="0,4,0,8"
                    Command="{Binding GoToWorkoutsCommand}" />

            <Button Text="See Progress"
                    Style="{StaticResource PrimaryButton}"
                    Margin="0,0,0,12"
                    Command="{Binding GoToProgressCommand}" />

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
